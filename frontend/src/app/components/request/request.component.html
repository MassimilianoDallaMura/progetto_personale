<div style="text-align: start;">
  <!-- Header fisso -->
  <div style="height: 48px; background-color: white;"></div>

  <div style="position: fixed; width: 100%; z-index: 1000; border-bottom: 1px solid rgb(147, 147, 147);">
    <mat-toolbar style="display: flex; justify-content: space-between; align-items: center; background-color: white">
      <div>
        <img src="../../../assets/Logo_DonaTo.svg" alt="Logo Donato" height="30">
      </div>
      <h1>Richieste</h1>
      <button mat-icon-button aria-label="notifications">
        <mat-icon matBadge="15" matBadgeColor="warn">notifications</mat-icon>
        <span class="cdk-visually-hidden">Notifications</span>
      </button>
    </mat-toolbar>
  </div>

  <mat-tab-group style="margin-top: 60px;">
    <mat-tab label="Le tue richieste" [ngClass]="{'custom-selected-tab': selectedTabIndex === 0}">
      <ng-container *ngIf="userRequests.length > 0; else noUserRequests">
        <div class="request-card-container" 
        *ngFor="let request of userRequests"
        (click)="viewChat(request.id, request.statusRequest)"
        (touchstart)="onTouchStart($event)" 
        (touchmove)="onTouchMove($event)" 
        (touchend)="onTouchEnd($event, request)">
        <mat-card class="request-card">
          <div style="display: flex;">
            <div style="flex: 0 0 100px;">
              <img mat-card-image [src]="request.product.photos[0]" alt="Immagine Prodotto" style="width: 80px; height: 80px; object-fit: cover;">
            </div>
            <div style="flex: 1; padding-left: 10px;">
              <div class="request-details">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <h3>{{ request.product.title }}</h3>
                  <img [src]="request.owner.avatar" alt="Avatar Proprietario" class="avatar" style="width: 20px; height: 20px; border-radius: 50%;">
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <p [ngClass]="getStatusClass(request.statusRequest)">{{ request.statusRequest }}</p>
                </div>
              </div>
            </div>
          </div>
        </mat-card>
      </div>
      </ng-container>
      <ng-template #noUserRequests>
        <p>Nessuna richiesta disponibile.</p>
      </ng-template>
    </mat-tab>

    <mat-tab label="Richieste per i tuoi prodotti" [ngClass]="{'custom-selected-tab': selectedTabIndex === 1}">
      <ng-container *ngIf="ownerRequests.length > 0; else noOwnerRequests">
        <div class="request-card-container" 
        *ngFor="let request of ownerRequests"
        (click)="viewChat(request.id, request.statusRequest)"
        (touchstart)="onTouchStart($event)" 
        (touchmove)="onTouchMove($event)" 
        (touchend)="onTouchEnd($event, request)">
        <mat-card class="request-card">
          <div style="display: flex;">
            <div style="flex: 0 0 100px;">
              <img mat-card-image [src]="request.product.photos[0]" alt="Immagine Prodotto" style="width: 80px; height: 80px; object-fit: cover;">
            </div>
            <div style="flex: 1; padding-left: 10px;">
              <div class="request-details">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <h3>{{ request.product.title }}</h3>
                  <img [src]="request.user.avatar" alt="Avatar Richiedente" class="avatar" style="width: 20px; height: 20px; border-radius: 50%; margin-left: 10px;">
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <p [ngClass]="getStatusClass(request.statusRequest)">{{ request.statusRequest }}</p>
                </div>
              </div>
            </div>
          </div>
        </mat-card>
      </div>
      </ng-container>
      <ng-template #noOwnerRequests>
        <p>Nessuna richiesta per i tuoi prodotti disponibile.</p>
      </ng-template>
    </mat-tab>
  </mat-tab-group>

  <app-footer></app-footer>
</div>
